{
  "type": "Microsoft.Authorization/policyAssignments",
  "apiVersion": "2024-04-01",
  "name": "Deny-L3-IP-Routing",
  "location": "${default_location}",
  "dependsOn": [],
  "identity": {
    "type": "None"
  },
  "properties": {
    "description": "This initiative assignment will prevent the creation of network resources that enable Layer 3 IP routing, such as ExpressRoute circuits and gateways, Virtual WANs and Hubs, VPN gateways, and P2S VPN gateways. It will also prevent vNet Peering cross Subscription. This is to ensure that the subscriptions remain isolated and do not have connectivity to on-premises or other virtual networks.",
    "displayName": "Deny Layer 3 IP Routing and vNet Peering cross subscription",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/placeholder/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
    "enforcementMode": "Default",
    "nonComplianceMessages": [
      {
        "message": "Creation of network resources that enable Layer 3 IP routing or vNet Peering outside of the same subscription is not allowed."
      }
    ],
    "parameters": {
      "listOfResourceTypesNotAllowed": {
        "value": [
          "microsoft.network/expressroutecircuits",
          "microsoft.network/expressroutegateways",
          "microsoft.network/expressrouteports",
          "microsoft.network/virtualwans",
          "microsoft.network/virtualhubs",
          "microsoft.network/vpngateways",
          "microsoft.network/p2svpngateways",
          "microsoft.network/vpnsites",
          "microsoft.network/virtualnetworkgateways"
        ]
      },
      "effectNotAllowedResources": {
        "value": "Deny"
      },
      "effectDenyVnetPeering": {
        "value": "Deny"
      }
    },
    "scope": "/providers/Microsoft.Management/managementGroups/placeholder",
    "notScopes": []
  }
}